<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report name" pageWidth="595" pageHeight="842" columnWidth="535" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<parameter name="p_fechaInicialSqlServer" class="java.lang.String"/>
	<parameter name="p_fechaFinalSqlServer" class="java.lang.String"/>
	<parameter name="p_nombreLocal" class="java.lang.String"/>
	<parameter name="p_indicadorINI" class="java.lang.Integer"/>
	<parameter name="p_indicadorFIN" class="java.lang.Integer"/>
	<parameter name="p_idTipoOrdenINI" class="java.lang.Integer"/>
	<parameter name="p_idLocal" class="java.lang.Integer"/>
	<parameter name="p_nit" class="java.lang.String"/>
	<parameter name="p_titulo" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT tblDctosOrdenesDetalle.idLocal,
        tblDctosOrdenesDetalle.CANTIDAD,
	   tblDctosOrdenesDetalle.IDPLU,
	   tblDctosOrdenesDetalle.VRVENTAUNITARIO,
	   tblDctosOrdenesDetalle.NOMBREPLU,
           tblDctosOrdenesDetalle.VRVENTAORIGINAL,
	   ctrlUsuarios.aliasUsuario,
	   tblDctos.fechaDcto,
           tblDctos.idDcto,
	   ((tblDctosOrdenesDetalle.VRVENTAORIGINAL)
	   *(tblDctosOrdenesDetalle.CANTIDAD))
           - ((tblDctosOrdenesDetalle.VRVENTAUNITARIO) *
           (tblDctosOrdenesDetalle.CANTIDAD))
AS         vrDiferencia

FROM       tblDctos
INNER JOIN tblDctosOrdenesDetalle
ON tblDctos.IDLOCAL      =
                  tblDctosOrdenesDetalle.IDLOCAL
AND tblDctos.IDTIPOORDEN =
             tblDctosOrdenesDetalle.IDTIPOORDEN
AND tblDctos.IDORDEN     =
                 tblDctosOrdenesDetalle.IDORDEN
INNER JOIN ctrlUsuarios
ON tblDctos.IDUSUARIO    =
                        ctrlUsuarios.idUsuario
WHERE tblDctosOrdenesDetalle.VRVENTAUNITARIO
                       !=
         tblDctosOrdenesDetalle.VRVENTAORIGINAL
AND	  tblDctos.fechaDcto
BETWEEN $P{p_fechaInicialSqlServer}
AND $P{p_fechaFinalSqlServer}
AND	  tblDctos.idLocal = $P{p_idLocal}
AND	  tblDctos.idTipoOrden = $P{p_idTipoOrdenINI}
AND   tblDctos.indicador
BETWEEN $P{p_indicadorINI} AND $P{p_indicadorFIN}
ORDER BY tblDctos.idLocal,
          tblDctos.fechaDcto,
         tblDctos.idDcto]]>
	</queryString>
	<field name="CANTIDAD" class="java.lang.Double">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="IDPLU" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="VRVENTAUNITARIO" class="java.lang.Double">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="NOMBREPLU" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="VRVENTAORIGINAL" class="java.lang.Double">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="aliasUsuario" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="fechaDcto" class="java.lang.String"/>
	<field name="idDcto" class="java.lang.Double"/>
	<field name="vrDiferencia" class="java.lang.Double"/>
	<field name="idLocal" class="java.lang.Integer"/>
	<variable name="v_vrVentaOriginal" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{VRVENTAORIGINAL}]]></variableExpression>
	</variable>
	<variable name="v_numeroPlus" class="java.lang.Integer" calculation="Count">
		<variableExpression><![CDATA[$F{IDPLU}]]></variableExpression>
	</variable>
	<variable name="v_vrDiferencia" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{vrDiferencia}]]></variableExpression>
	</variable>
	<variable name="v_vrModificado" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{VRVENTAUNITARIO}]]></variableExpression>
	</variable>
	<variable name="v_cantidad" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{CANTIDAD}]]></variableExpression>
	</variable>
	<group name="local">
		<groupExpression><![CDATA[$F{idLocal}]]></groupExpression>
		<groupFooter>
			<band height="10">
				<staticText>
					<reportElement x="30" y="0" width="100" height="10"/>
					<textElement>
						<font size="6"/>
					</textElement>
					<text><![CDATA[TOTALES]]></text>
				</staticText>
				<textField pattern="#,##0">
					<reportElement x="145" y="0" width="30" height="10"/>
					<textElement textAlignment="Right">
						<font size="6"/>
					</textElement>
					<textFieldExpression class="java.lang.Integer"><![CDATA[$V{v_numeroPlus}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00">
					<reportElement x="412" y="0" width="40" height="10"/>
					<textElement textAlignment="Right">
						<font size="6"/>
					</textElement>
					<textFieldExpression class="java.lang.Double"><![CDATA[$V{v_vrDiferencia}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00">
					<reportElement x="360" y="0" width="40" height="10"/>
					<textElement textAlignment="Right">
						<font size="6"/>
					</textElement>
					<textFieldExpression class="java.lang.Double"><![CDATA[$V{v_cantidad}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band/>
	</background>
	<title>
		<band height="60">
			<textField>
				<reportElement x="2" y="0" width="555" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Verdana" size="14" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{p_nombreLocal}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="2" y="20" width="555" height="20"/>
				<textElement textAlignment="Center">
					<font fontName="Verdana" size="10" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{p_nit}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="2" y="40" width="555" height="20"/>
				<textElement textAlignment="Center"/>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{p_titulo}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band height="20">
			<staticText>
				<reportElement x="0" y="0" width="20" height="11"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<text><![CDATA[PLU]]></text>
			</staticText>
			<staticText>
				<reportElement x="30" y="0" width="100" height="11"/>
				<textElement textAlignment="Left">
					<font size="8"/>
				</textElement>
				<text><![CDATA[NOMBRE PLU]]></text>
			</staticText>
			<staticText>
				<reportElement x="253" y="0" width="40" height="11"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<text><![CDATA[V. ORIG]]></text>
			</staticText>
			<staticText>
				<reportElement x="308" y="0" width="40" height="11"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<text><![CDATA[V. MOD]]></text>
			</staticText>
			<staticText>
				<reportElement x="475" y="0" width="58" height="11"/>
				<textElement textAlignment="Left">
					<font size="8"/>
				</textElement>
				<text><![CDATA[ALIAS]]></text>
			</staticText>
			<staticText>
				<reportElement x="145" y="0" width="30" height="11"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<text><![CDATA[DCTO]]></text>
			</staticText>
			<staticText>
				<reportElement x="194" y="0" width="46" height="11"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[FEC.DOC]]></text>
			</staticText>
			<staticText>
				<reportElement x="360" y="0" width="40" height="11"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<text><![CDATA[CANT]]></text>
			</staticText>
			<staticText>
				<reportElement x="412" y="0" width="40" height="11"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<text><![CDATA[V. DIF]]></text>
			</staticText>
		</band>
	</pageHeader>
	<columnHeader>
		<band/>
	</columnHeader>
	<detail>
		<band height="10">
			<textField>
				<reportElement x="0" y="0" width="20" height="10"/>
				<textElement textAlignment="Right">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{IDPLU}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="30" y="0" width="100" height="10"/>
				<textElement textAlignment="Left">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{NOMBREPLU}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="253" y="0" width="40" height="10"/>
				<textElement textAlignment="Right">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.Double"><![CDATA[$F{VRVENTAORIGINAL}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="308" y="0" width="40" height="10"/>
				<textElement textAlignment="Right">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.Double"><![CDATA[$F{VRVENTAUNITARIO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="475" y="0" width="58" height="10"/>
				<textElement textAlignment="Left">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{aliasUsuario}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="145" y="0" width="30" height="10"/>
				<textElement textAlignment="Right">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.Double"><![CDATA[$F{idDcto}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="194" y="0" width="46" height="10"/>
				<textElement textAlignment="Center">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{fechaDcto}.substring( 0, 10 )]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="360" y="0" width="40" height="10"/>
				<textElement textAlignment="Right">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.Double"><![CDATA[$F{CANTIDAD}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="412" y="0" width="40" height="10"/>
				<textElement textAlignment="Right">
					<font size="6"/>
				</textElement>
				<textFieldExpression class="java.lang.Double"><![CDATA[$F{vrDiferencia}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band isSplitAllowed="false"/>
	</columnFooter>
	<pageFooter>
		<band/>
	</pageFooter>
	<summary>
		<band/>
	</summary>
</jasperReport>
